##,Sensitivity Analysis


mu1=2;mu2=1.8;mu3=1
b2=0.5;b3=0.8;b1=0.2

n1=150
max_RF1=c(0.002219982,0.05386223,0.03306803,1.877426,-0.43264145,0.3629209)
max_svm1=c(-0.011373882,0.11252317,0.05814208,15.429264,-0.30715052,0.3080224)
max_knn1=c(-0.005711415,0.15027816,0.09958627,1.904445,-0.39088570,0.2587528)
max_lda1=c(0.017197938,0.11757990,0.14453366,34.283207,0.15056644,0.4582617)
max_cart1=c(-0.011869754,0.12154622,0.09172728,10.123333,-0.35890753,0.2868092)
max_nb1=c(0.018667567,0.15543963,0.10100535,-1.036176,-0.03472847,0.5148297)
max_ML1=c(-0.018311290,-0.03500080,-0.07492219,85.175344,6.26359258,-0.1501224)

n2=200
max_RF2=c(0.003862007,0.06651646,0.03992365,0.3922087,-0.47924931,0.31702059)
max_svm2=c(-0.015448536,0.12244217,0.07877842,7.5507993,-0.41889820,0.09393688)
max_knn2=c(-0.007042033,0.16502875,0.10966506,1.2676126,-0.48412354,0.15280121)
max_lda2=c(0.020440068,0.13280599,0.19250634,0.8080425,0.05866513,0.34452736)
max_cart2=c(-0.010430736,0.16146907,0.08379874,6.6448590,-0.40803134,0.19329721)
max_nb2=c(0.013828725,0.18479188,0.14134287,-0.8452478,-0.15600221,0.32935759)
max_ML2=c(-0.016997538,-0.03348526,-0.05071336,23.7548972,5.95620834,-0.12427332)


n3=250
max_RF3=c(0.002462745,0.05717639,0.01817131,1.2604282,-0.46077321,0.31106283)
max_svm3=c(-0.015106046,0.12363216,0.04802369,3.6924115,-0.37722152,0.01008062)
max_knn3=c(-0.007858745,0.15114244,0.08801093,1.5043151,-0.48930516,0.15195976)
max_lda3=c(0.017646549,0.11759022,0.16021956,5.0759812,0.01257694,0.34552365)
max_cart3=c(-0.010285875,0.14149834,0.07288324,5.7158194,-0.41990185,0.14270129)
max_nb3=c(0.014277708,0.17867799,0.11004410,-0.9461673,-0.12604550,0.33819864)
max_ML3=c(-0.016692335,-0.04837397,-0.06210522,40.5625808,4.79497230,-0.16778451)


n4=300
max_RF4=c(0.004180017,0.06570381,0.02011291,0.3946430,-0.54517050,0.28151325)
max_svm4=c(-0.017046137,0.12955349,0.05229861,7.1210439,-0.53588090,-0.01027533)
max_knn4=c(-0.008949857,0.14747210,0.07907101,1.4106645,-0.60723392,0.13459052)
max_lda4=c(0.018762861,0.14377957,0.17115473,-0.8797015,-0.09031854,0.29745869)
max_cart4=c(-0.013570453,0.13897944,0.05902426,6.7883802,-0.50214198,0.06421917)
max_nb4=c(0.015288963,0.17965562,0.11391575,-0.8839864,-0.22014918,0.31712516)
max_ML4=c(-0.018688673,-0.02753080,-0.07089040,28.1886180,3.00469642,-0.13400360)


n5=350
max_RF5=c(0.002168405,0.05135363,0.01426874,-0.09195078,-0.52582613,0.28581442)
max_svm5=c(-0.016188542,0.12552886,0.04486539,2.93743710,-0.43623935,-0.02567622)
max_knn5=c(-0.010587773,0.14066355,0.07666299,1.01734694,-0.56129402,0.11520487)
max_lda5=c(0.019742117,0.12122082,0.17371477,-1.26773511,0.09874629,0.32924836)
max_cart5=c(-0.014345459,0.13495513,0.05296285,3.42852798,-0.45387400,0.08511806)
max_nb5=c(0.009112714,0.16887352,0.09109778,-0.91257019,-0.27057362,0.29312468)
max_ML5=c(-0.018876084,-0.03810426,-0.07433781,17.15805366,3.77393714,-0.18244957)



n6=400
max_RF6=c(0.002468662,0.05340742,0.01590271,-0.003080473,-0.52169988,0.31775087)
max_svm6=c(-0.018919677,0.13598268,0.04229043,4.963555219,-0.48027671,0.03213982)
max_knn6=c(-0.010987294,0.13380633,0.08119603,1.022533580,-0.56013634,0.12402166)
max_lda6=c(0.018311239,0.12843730,0.18400508,-1.210151910,0.05178914,0.32670948)
max_cart6=c(-0.017200277,0.12806214,0.04073095,6.956962502,-0.44877913,0.06767309)
max_nb6=c(0.009861893,0.17254909,0.11213151,-0.873197234,-0.21835700,0.29066764)
max_ML6=c(-0.019137448,-0.04128003,-0.06756494,17.896764862,3.50843208,-0.12200776)



n7=450
max_RF7=c(0.001699153,0.05612417,0.005588327,0.2550297,-0.54166130,0.273560892)
max_svm7=c(-0.018088915,0.13783448,0.043627579,5.8138918,-0.47542219,-0.027900517)
max_knn7=c(-0.011793161,0.13545737,0.072019723,1.6644545,-0.59093540,0.104592962)
max_lda7=c(0.016984453,0.12120282,0.168862650,-0.4893670,-0.05667647,0.324786238)
max_cart7=c(-0.015251899,0.13448455,0.061494765,4.1433559,-0.42160047,-0.005766638)
max_nb7=c(0.006999622,0.17817393,0.099185143,-0.6969548,-0.33720215,0.246399905)
max_ML7=c(-0.018699463,-0.03578545,-0.073514669,20.7926255,2.93467246,-0.159360293)



n8=500
max_RF8=c(0.004022425,0.04983549,0.01239277,0.00945586,-0.54454713,0.305682317)
max_svm8=c(-0.015669907,0.14188680,0.05949150,2.86805768,-0.48416654,-0.003265569)
max_knn8=c(-0.009588772,0.13386856,0.09010500,0.83073389,-0.57922846,0.116703323)
max_lda8=c(0.019020538,0.12783101,0.18610959,-1.24942944,-0.03057885,0.311727803)
max_cart8=c(-0.014066960,0.13556514,0.07217228,3.43735691,-0.47829673,0.017349716)
max_nb8=c(0.010641294,0.19264223,0.11412179,-1.04166187,-0.27341501,0.260026694)
max_ML8=c(-0.016554714,-0.03618141,-0.06971302,16.93704961,3.18617751,-0.164475707)



x=c(n1,n2,n3,n4,n5,n6,n7,n8)


n150=matrix(abs(c(max_RF1,max_svm1,max_knn1,max_lda1,max_cart1,max_nb1,max_ML1)),byrow = T , ncol=6)

n200=matrix(abs(c(max_RF2,max_svm2,max_knn2,max_lda2,max_cart2,max_nb2,max_ML2)),byrow = T , ncol=6)

n250=matrix(abs(c(max_RF3,max_svm3,max_knn3,max_lda3,max_cart3,max_nb3,max_ML3)),byrow = T , ncol=6)

n300=matrix(abs(c(max_RF4,max_svm4,max_knn4,max_lda4,max_cart4,max_nb4,max_ML4)),byrow = T , ncol=6)

n350=matrix(abs(c(max_RF5,max_svm5,max_knn5,max_lda5,max_cart5,max_nb5,max_ML5)),byrow = T , ncol=6)

n400=matrix(abs(c(max_RF6,max_svm6,max_knn6,max_lda6,max_cart6,max_nb6,max_ML6)),byrow = T , ncol=6)

n450=matrix(abs(c(max_RF7,max_svm7,max_knn7,max_lda7,max_cart7,max_nb7,max_ML7)),byrow = T , ncol=6)

n500=matrix(abs(c(max_RF8,max_svm8,max_knn8,max_lda8,max_cart8,max_nb8,max_ML8)),byrow = T , ncol=6)

n150[,4]=n150[,4]/10

n200[,4]=n200[,4]/10

n250[,4]=n250[,4]/10

n300[,4]=n300[,4]/10

n350[,4]=n350[,4]/10

n400[,4]=n400[,4]/10

n450[,4]=n450[,4]/10

n500[,4]=n500[,4]/10





par(mfrow=c(3,2))

for(j in 1:6){

  if(j==1){  
    plot(x,c(n150[1,j],n200[1,j],n250[1,j],n300[1,j],n350[1,j],n400[1,j],n450[1,j],n500[1,j]),
                 type = "l",col=1, xlab = "sample size", ylab = "Biasness", ylim = c(0,0.1), lty=2, lwd=2 , main =expression(b[1]))
    
    for(ii in 2:7){ 
      lines(x,c(n150[ii,j],n200[ii,j],n250[ii,j],n300[ii,j],n350[ii,j],n400[ii,j],n450[ii,j],n500[ii,j]),
            type = "l", xlab = "sample size", ylab = "Biasness", col=ii)
      
    }
    }

  if(j==2){  
    plot(x,c(n150[1,j],n200[1,j],n250[1,j],n300[1,j],n350[1,j],n400[1,j],n450[1,j],n500[1,j]),
                  type = "l",col=1, xlab = "sample size", ylab = "Biasness", ylim = c(0,2), lty=2, lwd=2 , main =expression(b[2]))
    
    for(ii in 2:7){ 
      lines(x,c(n150[ii,j],n200[ii,j],n250[ii,j],n300[ii,j],n350[ii,j],n400[ii,j],n450[ii,j],n500[ii,j]),
            type = "l", xlab = "sample size", ylab = "Biasness", col=ii, lty=2, lwd=2)
      
    }
  }
  
  if(j==3){  
    plot(x,c(n150[1,j],n200[1,j],n250[1,j],n300[1,j],n350[1,j],n400[1,j],n450[1,j],n500[1,j]),
                type = "l",col=1, xlab = "sample size", ylab = "Biasness", ylim = c(0,0.2), lty=2, lwd=2,  main =expression(b[3]))
    
    for(ii in 2:7){ 
      lines(x,c(n150[ii,j],n200[ii,j],n250[ii,j],n300[ii,j],n350[ii,j],n400[ii,j],n450[ii,j],n500[ii,j]),
           type = "l", xlab = "sample size", ylab = "Biasness", col=ii, lty=2, lwd=2)
      
    }
  }
  
  if(j==4){  
    plot(x,c(n150[1,j],n200[1,j],n250[1,j],n300[1,j],n350[1,j],n400[1,j],n450[1,j],n500[1,j]),
                 type = "l",col=1, xlab = "sample size", ylab = "Biasness", ylim = c(0,10), lty=2, lwd=2, main =expression(mu[1]))
    
    for(ii in 2:7){ 
      lines(x,c(n150[ii,j],n200[ii,j],n250[ii,j],n300[ii,j],n350[ii,j],n400[ii,j],n450[ii,j],n500[ii,j]),
            type = "l", xlab = "sample size", ylab = "Biasness", col=ii, lty=2, lwd=2)
      
    }
  }
  
  if(j==5){  
    plot(x,c(n150[1,j],n200[1,j],n250[1,j],n300[1,j],n350[1,j],n400[1,j],n450[1,j],n500[1,j]),
         type = "l",col=1, xlab = "sample size", ylab = "Biasness", ylim = c(0,6.5), lty=2, lwd=2, main =expression(mu[2]))
    
    for(ii in 2:7){ 
      lines(x,c(n150[ii,j],n200[ii,j],n250[ii,j],n300[ii,j],n350[ii,j],n400[ii,j],n450[ii,j],n500[ii,j]),
            type = "l", xlab = "sample size", ylab = "Biasness", col=ii, lty=2, lwd=2)
      
    }
  }
  
  if(j==6){  
    plot(x,c(n150[1,j],n200[1,j],n250[1,j],n300[1,j],n350[1,j],n400[1,j],n450[1,j],n500[1,j]),
         type = "l",col=1, xlab = "sample size", ylab = "Biasness", ylim = c(0,0.6), lty=2, lwd=2, main =expression(mu[3]))
    
    for(ii in 2:7){ 
      lines(x,c(n150[ii,j],n200[ii,j],n250[ii,j],n300[ii,j],n350[ii,j],n400[ii,j],n450[ii,j],n500[ii,j]),
            type = "l", xlab = "sample size", ylab = "Biasness", col=ii, lty=2, lwd=2)
      
    }
  }
  
 }



legend(-100,4.8, ncol = 4, legend=c("RF","SVM","KNN","LDA","CART","NB","ORD"),
       fill=c(1:7), title="",xpd="")

